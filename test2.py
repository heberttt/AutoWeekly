import requests

url = "https://graph.microsoft.com/v1.0/me/mailFolders/AAMkADU0Mzg2MmE2LWViMzUtNGE1ZS1hZDQ0LTk2MmM2MGNkZDIyYQAuAAAAAAB4QN-ZOOP-TKlJMM1LivqwAQBGfceSSpa_Qb5ED6dUdqY4AABEH2ZpAAA=/messages?$select=subject&$top=1000" 

bearer = 'Bearer eyJ0eXAiOiJKV1QiLCJub25jZSI6Ik42UU50dHdydmhlWWdhM3JuTWZ6Vzc4Z1l6U1N0ekVkT2NSdTRJclN2c1kiLCJhbGciOiJSUzI1NiIsIng1dCI6InEtMjNmYWxldlpoaEQzaG05Q1Fia1A1TVF5VSIsImtpZCI6InEtMjNmYWxldlpoaEQzaG05Q1Fia1A1TVF5VSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8wZmVkMDNhMy00MDJkLTQ2MzMtYThjZC04YjMwODgyMjI1M2UvIiwiaWF0IjoxNzExOTcxNTMwLCJuYmYiOjE3MTE5NzE1MzAsImV4cCI6MTcxMjA1ODIzMCwiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IkFWUUFxLzhXQUFBQVRYUjFWRzQ4cTRKb2t2ZlRhYmc5T3pZeDExazN2RlNWRjYyOEZTa1pHU0JtQm1wWEdvT24zRUV5TGFGVEFTRG1sOWdsVmJ4SUZKd1VHZ2VONU51Z281eWNkcmsrNDU0eHFKMjBINzViWmdBPSIsImFtciI6WyJwd2QiLCJtZmEiXSwiYXBwX2Rpc3BsYXluYW1lIjoiR3JhcGggRXhwbG9yZXIiLCJhcHBpZCI6ImRlOGJjOGI1LWQ5ZjktNDhiMS1hOGFkLWI3NDhkYTcyNTA2NCIsImFwcGlkYWNyIjoiMCIsImdpdmVuX25hbWUiOiJIZWJlcnQgUHJhdGFtYSIsImlkdHlwIjoidXNlciIsImlwYWRkciI6IjIxOS45My4xNi4xMzAiLCJuYW1lIjoiSGViZXJ0IFByYXRhbWEiLCJvaWQiOiI2MWMzZDU5Zi03OGFhLTQxZGEtYmMxZi0yMDdiNjE2MWEyM2UiLCJvbnByZW1fc2lkIjoiUy0xLTUtMjEtMTYxNDg5NTc1NC0xMTMwMDc3MTQtMTcwODUzNzc2OC0xNzE0NjkiLCJwbGF0ZiI6IjMiLCJwdWlkIjoiMTAwMzIwMDMxMjYwOTgyNCIsInJoIjoiMC5BWElBb3dQdER5MUFNMGFvellzd2lDSWxQZ01BQUFBQUFBQUF3QUFBQUFBQUFBQnlBT3cuIiwic2NwIjoiTWFpbC5SZWFkIE1haWwuUmVhZEJhc2ljIE1haWwuUmVhZFdyaXRlIE1haWwuU2VuZCBNYWlsYm94U2V0dGluZ3MuUmVhZCBvcGVuaWQgcHJvZmlsZSBUYXNrcy5SZWFkIFRhc2tzLlJlYWRXcml0ZSBVc2VyLlJlYWQgZW1haWwgRmlsZXMuUmVhZC5BbGwiLCJzaWduaW5fc3RhdGUiOlsia21zaSJdLCJzdWIiOiI1ejAzOFNlT2ozY0lWazVhZkZEaENleTdhZjZiMUxJemhNOFJSdTVnS3BFIiwidGVuYW50X3JlZ2lvbl9zY29wZSI6IkFTIiwidGlkIjoiMGZlZDAzYTMtNDAyZC00NjMzLWE4Y2QtOGIzMDg4MjIyNTNlIiwidW5pcXVlX25hbWUiOiJoZWJlcnQucHJhdGFtYUBjbG91ZG1haWxzLmFwdS5lZHUubXkiLCJ1cG4iOiJoZWJlcnQucHJhdGFtYUBjbG91ZG1haWxzLmFwdS5lZHUubXkiLCJ1dGkiOiJ2OGRlanZLRUNrT1VVVnFuZkdaQUFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX2NjIjpbIkNQMSJdLCJ4bXNfc3NtIjoiMSIsInhtc19zdCI6eyJzdWIiOiJpZ0tiQjRhZXFiZGIxQ1BKR1N2OC1NdGlkVHNyd1BXekZUZ0NyNWxLYjdzIn0sInhtc190Y2R0IjoxMzQ2NzQ2MTM4fQ.16k12gGYCm7PvlKxQn7zJgJzGpAXIlp2pGz-XuZWIbO5GWKCK99xwX57VNq7jIO0NtjA_2gmss9dwLNRaJNE077JlWPmeXDUEtqHWiv7M0gnuh2TTntvzu1OWGUTwwmWNe42-JKaW4SH4Ob-lH_-q9syEhJnlgkAjTpoxjbe2YDHWtm-QcU5x75qsnEB3-_vHCwaZX_sMupjRM8EqtvO4KOKLMRZT8gFip1l7XnBRZ4eC-J9mqkeBGhCGFdW0yNrAlMPxX3aCrUfcHEGWZygLayDa4qrcCuKejFqRJI-HvF2qa6afGTee5cCvFknyyZRMNYWjF7FPArj_nuEqVTFHA'


headers = {
        'Authorization' : bearer,
        'Content-Type' : 'application/json'
}

response = requests.get(url, headers=headers)

data = response.json()


for i in  data["value"]:
    print(i["subject"])


#print(data["value"][0]["subject"])
